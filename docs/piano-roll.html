<!DOCTYPE html>
<html lang="en-PH">
<head>
  <meta charset="UTF-8">
  <title>Piano Keyboard Demo</title>
  <link rel="stylesheet" type="text/css" href="../src/piano-keyboard.css">
  <style>
    .piano-keyboard {
      height: 50px;
      /*transform: rotate(-90deg) translateX(-100%);*/
      /*transform-origin: top left;*/
    }
  </style>
</head>
<body>

<h1>Piano Roll</h1>

<div id="piano-keyboard" class="piano-keyboard" data-white-key-width="8" data-start-key="-20" data-end-key="107" data-key-proportion="balanced"></div>

<script src="../node_modules/webmidi/webmidi.min.js"></script>
<script src="../src/piano-keyboard.js"></script>

<script>
//  document.getElementById('piano-keyboard').addEventListener('noteon', function (e) {
//    console.log(e.pitch + e.octave);
//  });

  WebMidi.enable(function (err) {
      var output;

      if (!!err) {
          return;
      }

      output = WebMidi.outputs[0];

      if (!output) {
          return;
      }

      Array.prototype.slice.call(document.querySelectorAll('.piano-keyboard'))
          .forEach(function initializePianoKeyboardSound(kbd, i) {
              kbd.addEventListener('noteon', function onNoteOn(e) {
                  output.playNote(e.key + 20, i + 1, { velocity: e.velocity / 127 });
              });

              kbd.addEventListener('noteoff', function onNoteOff(e) {
                  output.stopNote(e.key + 20, i + 1, { velocity: e.velocity / 127 });
              });
          });
  });
</script>
</body>
</html>
